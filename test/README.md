# TBot SDK 测试说明

## 测试结构

测试文件按照功能分为两大类：

### 静态功能测试 (`static/`)

静态功能主要测试数据收集和状态监控功能，不涉及机器人的实际运动：

- **`test_connection.cpp`** - 连接状态测试
  - 测试机器人连接功能
  - 测试连接状态检查
  - 测试服务状态检查
  - 测试断开连接功能

- **`test_data_stream.cpp`** - 数据流测试
  - 测试机器人数据流收集
  - 测试地图数据流收集
  - 测试数据内容验证
  - 测试连续数据接收

- **`test_robot_status.cpp`** - 机器人状态测试
  - 测试机器人状态获取
  - 测试电池状态获取
  - 测试系统状态获取
  - 测试状态边界条件

- **`test_map_status.cpp`** - 地图状态测试
  - 测试地图列表获取
  - 测试当前地图获取
  - 测试地图状态检查
  - 测试地图内容验证

### 动态功能测试 (`dynamic/`)

动态功能主要测试机器人的运动控制和导航功能：

- **`test_navigation.cpp`** - 导航功能测试
  - 测试启动导航
  - 测试导航到指定位置
  - 测试同步导航
  - 测试导航状态控制（暂停/恢复/停止）
  - 测试导航参数验证

- **`test_velocity_control.cpp`** - 速度控制测试
  - 测试速度控制命令
  - 测试最大速度设置
  - 测试停止和紧急停止
  - 测试不同运动模式（前进/后退/转向）
  - 测试速度限制和精度

- **`test_waypoints.cpp`** - 导航点管理测试
  - 测试保存当前位置作为导航点
  - 测试加载导航点信息
  - 测试获取所有导航点
  - 测试导航到导航点
  - 测试删除导航点

## 运行测试

### 构建测试

```bash
# 在项目根目录
mkdir build
cd build
cmake ..
make
```

### 运行所有测试

```bash
# 在项目根目录
bash test/run_all_tests.sh
```

### 运行静态功能测试

```bash
bash test/run_static_tests.sh
```

### 运行动态功能测试

```bash
bash test/run_dynamic_tests.sh
```

### 运行单个测试

```bash
# 在build目录下
./test/test_connection
./test/test_data_stream
./test/test_robot_status
./test/test_map_status
./test/test_navigation
./test/test_velocity_control
./test/test_waypoints
```

## 测试特点

### 使用Mock对象

所有测试都使用Google Mock框架创建Mock对象，避免依赖实际的机器人硬件：

- 模拟网络连接
- 模拟数据流
- 模拟状态响应
- 模拟导航行为

### 测试覆盖范围

- **功能测试**：验证每个API的正确性
- **参数验证**：测试边界条件和无效输入
- **错误处理**：测试失败情况的处理
- **状态转换**：测试不同状态之间的转换
- **回调函数**：测试异步回调的正确性

### 测试数据

- 使用真实的坐标范围（-100到100米）
- 使用合理的速度范围（0到5 m/s）
- 使用标准的四元数表示方向
- 使用中文名称和描述

## 注意事项

1. **不包含建图功能**：按照要求，建图功能使用上位机，不在此SDK中测试
2. **Mock测试**：所有测试都是基于Mock的单元测试，不需要实际机器人
3. **异步回调**：测试中正确处理异步回调函数
4. **错误处理**：测试各种错误情况的处理
5. **中文支持**：测试支持中文名称和描述

## 测试结果

测试成功时会显示：
```
✓ 连接状态测试通过
✓ 数据流测试通过
✓ 机器人状态测试通过
✓ 地图状态测试通过
✓ 导航功能测试通过
✓ 速度控制测试通过
✓ 导航点管理测试通过
🎉 所有测试通过！
```

测试失败时会显示具体的错误信息，帮助定位问题。 